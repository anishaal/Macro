import tkinter as tk
from tkinter import ttk, messagebox
import win32com.client as win32
import os

EXCEL_FILE = r"C:\Path\YourMacroWorkbook.xlsm"  # <-- change this
MACRO_NAME = "YourMacroName"                    # <-- change this

def run_macro():
    site_id = entry.get().strip()

    if not site_id:
        messagebox.showwarning("Input Error", "Please enter a Site ID.")
        return

    if not os.path.exists(EXCEL_FILE):
        messagebox.showerror("File Error", "Excel macro file not found.")
        return

    try:
        messagebox.showinfo("Running", "Running macro, please wait...")

        excel = win32.Dispatch("Excel.Application")
        excel.Visible = False  # run in background

        wb = excel.Workbooks.Open(EXCEL_FILE)
        excel.Application.Run(f"'{wb.Name}'!{MACRO_NAME}", site_id)
        wb.Close(SaveChanges=True)
        excel.Quit()

        messagebox.showinfo("Success", "Macro completed successfully!")

    except Exception as e:
        messagebox.showerror("Error", f"An error occurred:\n{e}")

# UI Setup
root = tk.Tk()
root.title("Site Macro Runner")
root.geometry("370x200")
root.resizable(False, False)

root.configure(bg="#f2f7fa")
style = ttk.Style()
style.theme_use("clam")
style.configure("TButton", font=("Segoe UI", 12), background="#468cf4", foreground="#fff", borderwidth=0)
style.map("TButton", background=[("active", "#3773c0")])
style.configure("TEntry", font=("Segoe UI", 12), padding=4)
style.configure("TLabel", font=("Segoe UI", 13, "bold"), background="#f2f7fa", foreground="#444")

label = ttk.Label(root, text="Enter Site ID:")
label.pack(pady=(18, 8))

frame = tk.Frame(root, bg="#f2f7fa")
frame.pack()

entry = ttk.Entry(frame, width=28)
entry.pack(ipady=4)

run_button = ttk.Button(root, text="Run Macro", command=run_macro)
run_button.pack(pady=18, ipady=4, ipadx=8)

# Add rounded corner effect for entry widget (Windows only via visual illusion)
entry.configure(style="TEntry")

root.mainloop()
